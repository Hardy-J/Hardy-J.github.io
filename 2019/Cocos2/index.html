<!DOCTYPE html>


<html lang="zh-CN" >


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    深入CocosCreator |  Hui&#39;Blog
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  

<link rel="alternate" href="/atom.xml" title="Hui'Blog" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    <main class="content on">
      <section class="outer">
  <article id="post-Cocos2" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  深入CocosCreator
</h1>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2019/Cocos2/" class="article-date">
  <time datetime="2019-10-07T12:24:23.000Z" itemprop="datePublished">2019-10-07</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

      
      
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">5k字</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">21分钟</span>
        </span>
    </span>
</div>

      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <p> 前文再续，书接上一回。 这几天一直在通过视频，文档，深入的了解CocosCreator，并对一些知识点做了一下总结笔记</p>
<a id="more"></a>

<h2 id="资源小知识点"><a href="#资源小知识点" class="headerlink" title="资源小知识点"></a>资源小知识点</h2><h3 id="1-跨项目导入导出资源"><a href="#1-跨项目导入导出资源" class="headerlink" title="1.跨项目导入导出资源"></a>1.跨项目导入导出资源</h3><p>操作流程：</p>
<p> （1）导出：文件 =&gt; 资源导出，选择 .fire场景文件，输出assets目录的 .zip压缩包。<br> （2）导入：文件 =&gt; 资源导入，选择压缩包源路径、解压路径，输出assets目录内容。</p>
<h3 id="2-图像资源自动剪裁"><a href="#2-图像资源自动剪裁" class="headerlink" title="2.图像资源自动剪裁"></a>2.图像资源自动剪裁</h3><p>​    基于size mode，尽量去除spriteFrame无像素的部分，减小图片尺寸。</p>
<hr>
<h2 id="场景小知识点"><a href="#场景小知识点" class="headerlink" title="场景小知识点"></a>场景小知识点</h2><h3 id="1-场景中的元素"><a href="#1-场景中的元素" class="headerlink" title="1.场景中的元素"></a><strong>1.场景中的元素</strong></h3><p>​    即是节点，可内嵌组件</p>
<h3 id="2-坐标系"><a href="#2-坐标系" class="headerlink" title="2.坐标系"></a><strong>2.坐标系</strong></h3><table>
<thead>
<tr>
<th align="center">类别</th>
<th align="center">坐标轴方向</th>
</tr>
</thead>
<tbody><tr>
<td align="center">cocos坐标系（世界、本地坐标系）</td>
<td align="center">x右、y上、z外</td>
</tr>
<tr>
<td align="center">设备屏幕坐标系</td>
<td align="center">x右、y下</td>
</tr>
</tbody></table>
<h3 id="3-锚点"><a href="#3-锚点" class="headerlink" title="3.锚点"></a>3.锚点</h3><p><strong>作用：</strong>用于变换、子节点定位基准。</p>
<hr>
<h2 id="子系统重点"><a href="#子系统重点" class="headerlink" title="子系统重点"></a>子系统重点</h2><h3 id="1、渲染系统"><a href="#1、渲染系统" class="headerlink" title="1、渲染系统"></a>1、渲染系统</h3><p>​    对摄像机、渲染组件的了解。</p>
<h3 id="2、UI系统"><a href="#2、UI系统" class="headerlink" title="2、UI系统"></a>2、UI系统</h3><p>​    对widget、layout等UI组件的了解。</p>
<h3 id="3、动画系统"><a href="#3、动画系统" class="headerlink" title="3、动画系统"></a>3、动画系统</h3><p><strong>（1）创建动画的基本流程</strong><br> <strong>（2）时间曲线（双击动画线，进入编辑窗口）</strong><br> <strong>（3）事件管理（双击游标、加减按钮控制参数个数）</strong><br> <strong>（4）脚本控制</strong></p>
<h3 id="4、物理系统"><a href="#4、物理系统" class="headerlink" title="4、物理系统"></a>4、物理系统</h3><p><strong>碰撞组件（普通碰撞）</strong><br> （1）editing——是否为编辑模式<br> （2）regenerate points——计算图形边界，自定生成控制点，数值为控制点的生成密度 / 准确度<br> （3）ctrl + 点击——删除控制点<br> （4）组件类型：矩形、圆形、多边形<br> （5）设置碰撞组（项目 =&gt; 项目设置 =&gt; 分组设置）：<br> 制定分组 =&gt; 匹配分组 =&gt; 碰撞组件所在节点上，设置所属分组<br> （6）脚本控制</p>
<p><strong>Box2D物理引擎（高级碰撞）</strong></p>
<h3 id="5、音频系统"><a href="#5、音频系统" class="headerlink" title="5、音频系统"></a>5、音频系统</h3><p><strong>（1）audioSource组件</strong><br> <strong>（2）脚本控制</strong></p>
<hr>
<h2 id="脚本开发"><a href="#脚本开发" class="headerlink" title="脚本开发"></a>脚本开发</h2><h3 id="1、使用-cc-Class-声明类型"><a href="#1、使用-cc-Class-声明类型" class="headerlink" title="1、使用 cc.Class 声明类型"></a>1、使用 cc.Class 声明类型</h3><p><strong>（1）定义 CCClass</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Sprite = cc.Class(&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（2）实例化</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Sprite();</span><br></pre></td></tr></table></figure>

<p><strong>（3）判断类型</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc.<span class="built_in">log</span>(obj instanceof Sprite);       <span class="comment">//使用原生JS的instanceof</span></span><br></pre></td></tr></table></figure>

<p><strong>（4）构造函数（ctor）</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Sprite = cc.Class(&#123;</span><br><span class="line">    <span class="comment">//使用ctor声明构造函数</span></span><br><span class="line">    ctor: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        cc.log(<span class="keyword">this</span> <span class="keyword">instanceof</span> Sprite);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（5）实例方法</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Sprite = cc.Class(&#123;</span><br><span class="line">    <span class="comment">// 声明一个名叫 "print" 的实例方法</span></span><br><span class="line">    print: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（6）继承（extends）</strong></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父类</span></span><br><span class="line"><span class="keyword">var</span> Shape = cc.Class();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类</span></span><br><span class="line"><span class="keyword">var</span> Rect = cc.Class(&#123;</span><br><span class="line">    <span class="comment">//使用 extends 实现继承</span></span><br><span class="line">    <span class="keyword">extends</span>: Shape</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（7）父构造函数</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Shape = cc.Class(&#123;</span><br><span class="line">    ctor: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        cc.log(<span class="string">"Shape"</span>);    <span class="comment">// 实例化时，父构造函数会自动调用，</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Rect = cc.Class(&#123;</span><br><span class="line">    extends: Shape</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Square = cc.Class(&#123;</span><br><span class="line">    extends: Rect,</span><br><span class="line">    ctor: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        cc.log(<span class="string">"Square"</span>);   <span class="comment">// 再调用子构造函数</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> square = <span class="keyword">new</span> Square();</span><br></pre></td></tr></table></figure>

<p><strong>（8）完整声明属性</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;简单类型声明</span><br><span class="line">properties: &#123;</span><br><span class="line">    score: &#123;</span><br><span class="line">        &#x2F;&#x2F;这几个参数分别指定了 score 的默认值为 0，在 属性检查器 里，其属性名将显示为：“Score (player)”，并且当鼠标移到参数上时，显示对应的 Tooltip。</span><br><span class="line">        default: 0,</span><br><span class="line">        displayName: &quot;Score (player)&quot;,</span><br><span class="line">        tooltip: &quot;The score of player&quot;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;数组声明</span><br><span class="line">properties: &#123;</span><br><span class="line">    names: &#123;</span><br><span class="line">        default: [],</span><br><span class="line">        type: [cc.String]   &#x2F;&#x2F; 用 type 指定数组的每个元素都是字符串类型</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    enemies: &#123;</span><br><span class="line">        default: [],</span><br><span class="line">        type: [cc.Node]     &#x2F;&#x2F; type 同样写成数组，提高代码可读性</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;get&#x2F;set 声明</span><br><span class="line">properties: &#123;</span><br><span class="line">    width: &#123;</span><br><span class="line">        get: function () &#123;</span><br><span class="line">            return this._width;</span><br><span class="line">        &#125;,</span><br><span class="line">        set: function (value) &#123;</span><br><span class="line">            this._width &#x3D; value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>properties常用参数</strong></p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">default</td>
<td align="left">默认值</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">限定属性的数据类型</td>
</tr>
<tr>
<td align="left">visible</td>
<td align="left">若为false，则不在属性检查器面板中显示该属性</td>
</tr>
<tr>
<td align="left">serializable</td>
<td align="left">若为false，则不序列化（保存）该属性</td>
</tr>
<tr>
<td align="left">displayName</td>
<td align="left">在属性检查器面板中，显示成指定名字</td>
</tr>
<tr>
<td align="left">tooltip</td>
<td align="left">在属性检查器面板中，添加属性的Tooltip</td>
</tr>
</tbody></table>
<h3 id="2、访问节点和组件"><a href="#2、访问节点和组件" class="headerlink" title="2、访问节点和组件"></a>2、访问节点和组件</h3><p><strong>（1）获得组件所在的节点</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.node</span><br></pre></td></tr></table></figure>

<p><strong>（2）获得其它组件</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.getComponent(组件名)</span><br></pre></td></tr></table></figure>

<p><strong>（3）获得其它节点及其组件</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Player.js</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">    extends: cc.Component,</span><br><span class="line">    properties: &#123;</span><br><span class="line">        player: &#123;</span><br><span class="line">            default: null,</span><br><span class="line">            type: cc.Node</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;如果你将属性的 type 声明为 Player 组件，当你拖动节点 &quot;Player Node&quot; 到 属性检查器，player 属性就会被设置为这个节点里面的 Player 组件</span><br><span class="line">&#x2F;&#x2F; Cannon.js</span><br><span class="line">var Player &#x3D; require(&quot;Player&quot;);</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">    extends: cc.Component,</span><br><span class="line">    properties: &#123;</span><br><span class="line">        &#x2F;&#x2F; 声明 player 属性，这次直接是组件类型</span><br><span class="line">        player: &#123;</span><br><span class="line">            default: null,</span><br><span class="line">            type: Player</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;查找子节点</span><br><span class="line">&#x2F;&#x2F;返回子节点数组</span><br><span class="line">this.node.children</span><br><span class="line">&#x2F;&#x2F;返回对应的子节点</span><br><span class="line">this.node.getChildByName(子节点名);</span><br><span class="line">&#x2F;&#x2F;查找后代节点</span><br><span class="line">cc.find(子节点&#x2F;...&#x2F;后代节点, this.node);</span><br><span class="line">&#x2F;&#x2F;全局查找节点</span><br><span class="line">cc.find(场景&#x2F;节点&#x2F;节点&#x2F;...);</span><br></pre></td></tr></table></figure>

<p><strong>（4）访问已有变量里的值（通过模块访问）</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//专门开设一个中介模块，导出接口；在其他模块进行节点、组件、属性的操作</span></span><br><span class="line"><span class="comment">// Global.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    backNode: <span class="literal">null</span>,</span><br><span class="line">    backLabel: <span class="literal">null</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Back.js</span></span><br><span class="line"><span class="keyword">var</span> Global = <span class="built_in">require</span>(<span class="string">"Global"</span>);</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">    extends: cc.Component,</span><br><span class="line">    onLoad: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        Global.backNode = <span class="keyword">this</span>.node;</span><br><span class="line">        Global.backLabel = <span class="keyword">this</span>.getComponent(cc.Label);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// AnyScript.js</span></span><br><span class="line"><span class="keyword">var</span> Global = <span class="built_in">require</span>(<span class="string">"Global"</span>);</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">    extends: cc.Component,</span><br><span class="line">    start: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> text = <span class="string">"Back"</span>;</span><br><span class="line">        Global.backLabel.string = text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="3、常用节点和组件接口"><a href="#3、常用节点和组件接口" class="headerlink" title="3、常用节点和组件接口"></a>3、常用节点和组件接口</h3><p><strong>（1）节点状态和层级操作</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//激活/关闭节点</span></span><br><span class="line"><span class="keyword">this</span>.node.active = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">this</span>.node.active = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//更改节点的父节点</span></span><br><span class="line"><span class="keyword">this</span>.node.parent = parentNode;</span><br><span class="line"></span><br><span class="line"><span class="comment">//索引节点的子节点</span></span><br><span class="line"><span class="comment">//返回子节点数组</span></span><br><span class="line"><span class="keyword">this</span>.node.children</span><br><span class="line"><span class="comment">//返回子节点数量</span></span><br><span class="line"><span class="keyword">this</span>.node.childrenCount</span><br></pre></td></tr></table></figure>

<p><strong>（2）更改节点的变换（位置、旋转、缩放、尺寸）</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更改节点位置</span></span><br><span class="line"><span class="comment">//分别对 x 轴和 y 轴坐标赋值</span></span><br><span class="line"><span class="keyword">this</span>.node.x = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">this</span>.node.y = <span class="number">50</span>;</span><br><span class="line"><span class="comment">//使用setPosition方法</span></span><br><span class="line"><span class="keyword">this</span>.node.setPosition(<span class="number">100</span>, <span class="number">50</span>);</span><br><span class="line"><span class="keyword">this</span>.node.setPosition(cc.v2(<span class="number">100</span>, <span class="number">50</span>));</span><br><span class="line"><span class="comment">//设置position变量</span></span><br><span class="line"><span class="keyword">this</span>.node.position = cc.v2(<span class="number">100</span>, <span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//更改节点旋转</span></span><br><span class="line"><span class="keyword">this</span>.node.rotation = <span class="number">90</span>;</span><br><span class="line"><span class="keyword">this</span>.node.setRotation(<span class="number">90</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//更改节点缩放</span></span><br><span class="line"><span class="keyword">this</span>.node.scaleX = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">this</span>.node.scaleY = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">this</span>.node.setScale(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">this</span>.node.setScale(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//更改节点尺寸</span></span><br><span class="line"><span class="keyword">this</span>.node.setContentSize(<span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">this</span>.node.setContentSize(cc.size(<span class="number">100</span>, <span class="number">100</span>));</span><br><span class="line"><span class="keyword">this</span>.node.width = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">this</span>.node.height = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//更改节点锚点位置</span></span><br><span class="line"><span class="keyword">this</span>.node.anchorX = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">this</span>.node.anchorY = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">this</span>.node.setAnchorPoint(<span class="number">1</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p><strong>（3）颜色和不透明度</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置颜色</span></span><br><span class="line">mySprite.node.color = cc.Color.RED;</span><br><span class="line"><span class="comment">//设置不透明度</span></span><br><span class="line">mySprite.node.opacity = <span class="number">128</span>;</span><br></pre></td></tr></table></figure>

<p><strong>（4）常用组件接口</strong><br> cc.Component 是所有组件的基类，任何组件都包括如下的常见接口：</p>
<table>
<thead>
<tr>
<th align="left">接口</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">this.node</td>
<td align="left">该组件所属的节点实例</td>
</tr>
<tr>
<td align="left">this.enabled</td>
<td align="left">是否每帧执行该组件的 update 方法，同时也用来控制渲染组件是否显示</td>
</tr>
<tr>
<td align="left">update(dt)</td>
<td align="left">作为组件的成员方法，在组件的 enabled 属性为 true 时，其中的代码会每帧执行</td>
</tr>
<tr>
<td align="left">onLoad()</td>
<td align="left">组件所在节点进行初始化时（节点添加到节点树时）执行</td>
</tr>
<tr>
<td align="left">start()</td>
<td align="left">会在该组件第一次 update 之前执行，通常用于需要在所有组件的 onLoad 初始化完毕后执行的逻辑</td>
</tr>
</tbody></table>
<h3 id="4、生命周期"><a href="#4、生命周期" class="headerlink" title="4、生命周期"></a>4、生命周期</h3><table>
<thead>
<tr>
<th align="left">函数名</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">onLoad</td>
<td align="left">在节点首次激活时触发，或者所在节点被激活的情况下触发</td>
</tr>
<tr>
<td align="left">start</td>
<td align="left">在组件首次激活前</td>
</tr>
<tr>
<td align="left">update</td>
<td align="left">动画更新前</td>
</tr>
<tr>
<td align="left">lateUpdate</td>
<td align="left">动画更新后</td>
</tr>
<tr>
<td align="left">onEnable</td>
<td align="left">当组件的 enabled 属性从 false 变为 true 时，或者所在节点的 active 属性从 false 变为 true 时（倘若节点首次被创建且 enabled 为 true，则会在 onLoad 之后，start 之前被调用）</td>
</tr>
<tr>
<td align="left">onDisable</td>
<td align="left">当组件的 enabled 属性从 true 变为 false 时，或者所在节点的 active 属性从 true 变为 false 时</td>
</tr>
<tr>
<td align="left">onDestroy</td>
<td align="left">当组件或者所在节点调用了 destroy()时</td>
</tr>
</tbody></table>
<p><img src="https:////upload-images.jianshu.io/upload_images/11524092-7cf5b31340378b04.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/440/format/webp" alt="img"></p>
<h3 id="5、创建和销毁节点"><a href="#5、创建和销毁节点" class="headerlink" title="5、创建和销毁节点"></a>5、创建和销毁节点</h3><p><strong>（1）创建新节点</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cc.Class(&#123;</span><br><span class="line">  extends: cc.Component,</span><br><span class="line">  properties: &#123;</span><br><span class="line">    sprite: &#123;</span><br><span class="line">      default: null,</span><br><span class="line">      type: cc.SpriteFrame,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  start: function () &#123;</span><br><span class="line">    &#x2F;&#x2F;动态创建节点，并将它加入到场景中</span><br><span class="line">    var node &#x3D; new cc.Node(&#39;Sprite&#39;);</span><br><span class="line">    var sp &#x3D; node.addComponent(cc.Sprite);</span><br><span class="line">    sp.spriteFrame &#x3D; this.sprite;</span><br><span class="line">    node.parent &#x3D; this.node;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（2）克隆已有节点</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">  extends: cc.Component,</span><br><span class="line">  properties: &#123;</span><br><span class="line">    target: &#123;</span><br><span class="line">      default: null,</span><br><span class="line">      type: cc.Node,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  start: function () &#123;</span><br><span class="line">    &#x2F;&#x2F;克隆场景中的已有节点</span><br><span class="line">    var scene &#x3D; cc.director.getScene();</span><br><span class="line">    var node &#x3D; cc.instantiate(this.target);</span><br><span class="line">    node.parent &#x3D; scene;</span><br><span class="line">    node.setPosition(0, 0);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（3）创建预制节点</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">  extends: cc.Component,</span><br><span class="line">  properties: &#123;</span><br><span class="line">    target: &#123;</span><br><span class="line">      default: null,</span><br><span class="line">      type: cc.Prefab,    &#x2F;&#x2F;预制</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  start: function () &#123;</span><br><span class="line">    var scene &#x3D; cc.director.getScene();</span><br><span class="line">    var node &#x3D; cc.instantiate(this.target);</span><br><span class="line">    node.parent &#x3D; scene;</span><br><span class="line">    node.setPosition(0, 0);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（4）销毁节点</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line">cc.Class(&#123;</span><br><span class="line">  extends: cc.Component,</span><br><span class="line">  properties: &#123;</span><br><span class="line">    target: cc.Node,</span><br><span class="line">  &#125;,</span><br><span class="line">  start: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 5 秒后销毁目标节点</span></span><br><span class="line">    <span class="comment">//销毁节点并不会立刻被移除，而是在当前帧逻辑更新结束后，统一执行</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.target.destroy();</span><br><span class="line">    &#125;.bind(<span class="keyword">this</span>), <span class="number">5000</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  update: <span class="function"><span class="keyword">function</span> (<span class="params">dt</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//判断当前节点是否已经被销毁</span></span><br><span class="line">    <span class="keyword">if</span> (cc.isValid(<span class="keyword">this</span>.target)) &#123;</span><br><span class="line">      <span class="keyword">this</span>.target.rotation += dt * <span class="number">10.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PS：不要使用removeFromParent去销毁节点。<br> 原因：调用一个节点的 removeFromParent 后，它不一定就能完全从内存中释放，因为有可能由于一些逻辑上的问题，导致程序中仍然引用到了这个对象。</p>
</blockquote>
<h3 id="6、加载和切换场景"><a href="#6、加载和切换场景" class="headerlink" title="6、加载和切换场景"></a>6、加载和切换场景</h3><p><strong>（1）加载和切换</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从当前场景，切换到MyScene场景</span></span><br><span class="line">cc.director.loadScene(<span class="string">"MyScene"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>（2）通过常驻节点，进行场景资源管理和参数传递</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常驻节点：不随场景切换，而自动销毁，为所有场景提供持久性信息</span></span><br><span class="line"><span class="comment">//设置常驻节点</span></span><br><span class="line">cc.game.addPersistRootNode(myNode);</span><br><span class="line"><span class="comment">//取消常驻节点，还原为一般场景节点</span></span><br><span class="line">cc.game.removePersistRootNode(myNode);</span><br></pre></td></tr></table></figure>

<p><strong>（3）场景加载回调</strong></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fn：加载MyScene场景时触发</span></span><br><span class="line">cc.director.loadScene(<span class="string">"MyScene"</span>, <span class="function"><span class="keyword">fn</span>);</span></span><br></pre></td></tr></table></figure>

<p><strong>（4）预加载场景</strong></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//后台预加载场景</span></span><br><span class="line">cc.director.preloadScene(<span class="string">"MyScene"</span>, <span class="function"><span class="keyword">fn</span>);</span></span><br><span class="line"><span class="function">//有需要时，手动加载该场景</span></span><br><span class="line"><span class="function"><span class="title">cc</span>.<span class="title">director</span>.<span class="title">loadScene</span></span>(<span class="string">"MyScene"</span>, <span class="function"><span class="keyword">fn</span>);</span></span><br></pre></td></tr></table></figure>

<h3 id="7、获取和加载资源"><a href="#7、获取和加载资源" class="headerlink" title="7、获取和加载资源"></a>7、获取和加载资源</h3><p><strong>（1）资源属性的声明</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; NewScript.js</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">    extends: cc.Component,</span><br><span class="line">    properties: &#123;</span><br><span class="line">        &#x2F;&#x2F;所有继承自 cc.Asset 的类型都统称资源，如 cc.Texture2D, cc.SpriteFrame, cc.AnimationClip, cc.Prefab 等</span><br><span class="line">        texture: &#123;</span><br><span class="line">            default: null,</span><br><span class="line">            type: cc.Texture2D</span><br><span class="line">        &#125;,</span><br><span class="line">        spriteFrame: &#123;</span><br><span class="line">            default: null,</span><br><span class="line">            type: cc.SpriteFrame</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（2）静态加载（在属性检查器里设置资源）</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NewScript.js</span></span><br><span class="line">onLoad: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//拖拽资源管理器的资源，到属性检查器的脚本组件中，即可在脚本里拿到设置好的资源</span></span><br><span class="line">    <span class="keyword">var</span> spriteFrame = <span class="keyword">this</span>.spriteFrame;</span><br><span class="line">    <span class="keyword">var</span> texture = <span class="keyword">this</span>.texture;</span><br><span class="line">    spriteFrame.setTexture(texture);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>（3）动态加载</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//动态加载的资源，需要存放于assets的子目录resources中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//加载单个资源</span></span><br><span class="line"><span class="comment">//cc.loader.loadRes(resources的相对路径, 类型(可选), 回调函数)</span></span><br><span class="line"><span class="comment">//加载Prefab资源</span></span><br><span class="line">cc.loader.loadRes(<span class="string">"test assets/prefab"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(err, prefab)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> newNode = cc.instantiate(prefab);</span><br><span class="line">    cc.director.getScene().addChild(newNode);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//加载SpriteFrame</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">self</span> = this;</span><br><span class="line">cc.loader.loadRes(<span class="string">"test assets/image"</span>, cc.SpriteFrame, <span class="function"><span class="keyword">function</span> <span class="params">(err, spriteFrame)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">self</span>.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//批量加载资源</span></span><br><span class="line"><span class="comment">//cc.loader.loadResDir(resources的相对路径, 类型(可选), 回调函数)</span></span><br><span class="line"><span class="comment">//加载test assets目录下所有资源</span></span><br><span class="line">cc.loader.loadResDir(<span class="string">"test assets"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(err, assets)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//加载test assets目录下所有SpriteFrame，并且获取它们的路径</span></span><br><span class="line">cc.loader.loadResDir(<span class="string">"test assets"</span>, cc.SpriteFrame, <span class="function"><span class="keyword">function</span> <span class="params">(err, assets, urls)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//资源浅释放</span></span><br><span class="line"><span class="comment">//cc.loader.releaseRes(resources的相对路径, 类型(可选))</span></span><br><span class="line">cc.loader.releaseRes(<span class="string">"test assets/image"</span>, cc.SpriteFrame);</span><br><span class="line">cc.loader.releaseRes(<span class="string">"test assets/anim"</span>);</span><br><span class="line"><span class="comment">//cc.loader.releaseAsset(组件名)</span></span><br><span class="line">cc.loader.releaseAsset(spriteFrame);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 资源深释放，释放一个资源以及所有它依赖的资源</span></span><br><span class="line"><span class="keyword">var</span> deps = cc.loader.getDependsRecursively(<span class="string">'prefabs/sample'</span>);</span><br></pre></td></tr></table></figure>

<p><strong>（4）加载远程资源和设备资源</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载远程资源</span></span><br><span class="line"><span class="comment">//远程 url 带图片后缀名</span></span><br><span class="line"><span class="keyword">var</span> remoteUrl = <span class="string">"http://unknown.org/someres.png"</span>;</span><br><span class="line">cc.loader.load(remoteUrl, <span class="function"><span class="keyword">function</span> (<span class="params">err, texture</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//远程 url 不带图片后缀名，此时必须指定远程图片文件的类型</span></span><br><span class="line">remoteUrl = <span class="string">"http://unknown.org/emoji?id=124982374"</span>;</span><br><span class="line">cc.loader.load(&#123;<span class="attr">url</span>: remoteUrl, <span class="attr">type</span>: <span class="string">'png'</span>&#125;, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//加载设备资源</span></span><br><span class="line"><span class="comment">//用绝对路径加载设备存储内的资源，比如相册</span></span><br><span class="line"><span class="keyword">var</span> absolutePath = <span class="string">"/dara/data/some/path/to/image.png"</span></span><br><span class="line">cc.loader.load(absolutePath, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>加载限制：<br> 1、原生平台远程加载不支持图片文件以外类型的资源。<br> 2、这种加载方式只支持图片、声音、文本等原生资源类型，不支持SpriteFrame、SpriteAtlas、Tilemap等资源的直接加载和解析。（需要后续版本中的AssetBundle支持）<br> 3、Web端的远程加载受到浏览器的CORS跨域策略限制，如果对方服务器禁止跨域访问，那么会加载失败，而且由于WebGL安全策略的限制，即便对方服务器允许http请求成功之后也无法渲染。</p>
</blockquote>
<p><strong>（5）资源的依赖和释放</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接释放某个贴图</span></span><br><span class="line">cc.loader.release(texture);</span><br><span class="line"><span class="comment">// 释放一个 prefab 以及所有它依赖的资源</span></span><br><span class="line"><span class="keyword">var</span> deps = cc.loader.getDependsRecursively(<span class="string">'prefabs/sample'</span>);</span><br><span class="line">cc.loader.release(deps);</span><br><span class="line"><span class="comment">// 如果在这个 prefab 中有一些和场景其他部分共享的资源，你不希望它们被释放，可以将这个资源从依赖列表中删除</span></span><br><span class="line"><span class="keyword">var</span> deps = cc.loader.getDependsRecursively(<span class="string">'prefabs/sample'</span>);</span><br><span class="line"><span class="keyword">var</span> index = deps.indexOf(texture2d._uuid);</span><br><span class="line"><span class="keyword">if</span> (index !== <span class="number">-1</span>)</span><br><span class="line">    deps.splice(index, <span class="number">1</span>);</span><br><span class="line">cc.loader.release(deps);</span><br></pre></td></tr></table></figure>

<h3 id="8、监听和发射事件"><a href="#8、监听和发射事件" class="headerlink" title="8、监听和发射事件"></a>8、监听和发射事件</h3><p><strong>（1）监听事件</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//target是可选参数，用于绑定响应函数的调用者</span></span><br><span class="line"><span class="comment">//boolean是可选参数，默认为false，表示冒泡流</span></span><br><span class="line"><span class="keyword">this</span>.node.<span class="keyword">on</span>(<span class="keyword">event</span>, fn, target, boolean);</span><br></pre></td></tr></table></figure>

<p><strong>（2）关闭监听</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.node.off(<span class="keyword">event</span>, fn, target, boolean);</span><br></pre></td></tr></table></figure>

<p><strong>（3）发射事件</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//为事件函数，提供参数，最多5个</span></span><br><span class="line"><span class="keyword">this</span>.node.emit(<span class="keyword">event</span>, arg1, arg2, arg3);</span><br></pre></td></tr></table></figure>

<p><strong>（4）派送事件</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//grandson.js</span></span><br><span class="line"><span class="comment">//升级版的on，冒泡到的节点，全部注册事件</span></span><br><span class="line"><span class="keyword">this</span>.node.dispatchEvent( <span class="keyword">new</span> cc.Event.EventCustom(<span class="string">'foobar'</span>, <span class="literal">true</span>) );</span><br><span class="line"></span><br><span class="line"><span class="comment">//father.js</span></span><br><span class="line"><span class="comment">//在指定的上级节点中，注册相同的事件，阻止事件冒泡，手动停止派送</span></span><br><span class="line"><span class="keyword">this</span>.node.<span class="keyword">on</span>(<span class="string">'foobar'</span>, function (<span class="keyword">event</span>) &#123;</span><br><span class="line">  <span class="keyword">event</span>.stopPropagation();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>（5）事件对象（回调参数的event对象）</strong></p>
<table>
<thead>
<tr>
<th align="left">API 名</th>
<th align="left">类型</th>
<th align="left">意义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">type</td>
<td align="left">String</td>
<td align="left">事件的类型（事件名）</td>
</tr>
<tr>
<td align="left">target</td>
<td align="left">cc.Node</td>
<td align="left">接收到事件的原始对象</td>
</tr>
<tr>
<td align="left">currentTarget</td>
<td align="left">cc.Node</td>
<td align="left">接收到事件的当前对象，事件在冒泡阶段当前对象可能与原始对象不同</td>
</tr>
<tr>
<td align="left">getType</td>
<td align="left">Function</td>
<td align="left">获取事件的类型</td>
</tr>
<tr>
<td align="left">stopPropagation</td>
<td align="left">Function</td>
<td align="left">停止冒泡阶段，事件将不会继续向父节点传递，当前节点的剩余监听器仍然会接收到事件</td>
</tr>
<tr>
<td align="left">stopPropagationImmediate</td>
<td align="left">Function</td>
<td align="left">立即停止事件的传递，事件将不会传给父节点以及当前节点的剩余监听器</td>
</tr>
<tr>
<td align="left">getCurrentTarget</td>
<td align="left">Function</td>
<td align="left">获取当前接收到事件的目标节点</td>
</tr>
<tr>
<td align="left">detail</td>
<td align="left">Function</td>
<td align="left">自定义事件的信息（属于 cc.Event.EventCustom）</td>
</tr>
<tr>
<td align="left">setUserData</td>
<td align="left">Function</td>
<td align="left">设置自定义事件的信息（属于 cc.Event.EventCustom）</td>
</tr>
<tr>
<td align="left">getUserData</td>
<td align="left">Function</td>
<td align="left">获取自定义事件的信息（属于 cc.Event.EventCustom）</td>
</tr>
</tbody></table>
<h3 id="9、节点系统事件"><a href="#9、节点系统事件" class="headerlink" title="9、节点系统事件"></a>9、节点系统事件</h3><p><strong>（1）鼠标事件类型和事件对象</strong></p>
<table>
<thead>
<tr>
<th align="left">枚举对象定义</th>
<th align="left">对应的事件名</th>
<th align="left">事件触发的时机</th>
</tr>
</thead>
<tbody><tr>
<td align="left">cc.Node.EventType.MOUSE_DOWN</td>
<td align="left">mousedown</td>
<td align="left">当鼠标在目标节点区域按下时触发一次</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.MOUSE_ENTER</td>
<td align="left">mouseenter</td>
<td align="left">当鼠标移入目标节点区域时，不论是否按下</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.MOUSE_MOVE</td>
<td align="left">mousemove</td>
<td align="left">当鼠标在目标节点在目标节点区域中移动时，不论是否按下</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.MOUSE_LEAVE</td>
<td align="left">mouseleave</td>
<td align="left">当鼠标移出目标节点区域时，不论是否按下</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.MOUSE_UP</td>
<td align="left">mouseup</td>
<td align="left">当鼠标从按下状态松开时触发一次</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.MOUSE_WHEEL</td>
<td align="left">mousewheel</td>
<td align="left">当鼠标滚轮滚动时</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">函数名</th>
<th align="left">返回值类型</th>
<th align="left">意义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">getScrollY</td>
<td align="left">Number</td>
<td align="left">获取滚轮滚动的 Y 轴距离，只有滚动时才有效</td>
</tr>
<tr>
<td align="left">getLocation</td>
<td align="left">Object</td>
<td align="left">获取鼠标位置对象，对象包含 x 和 y 属性</td>
</tr>
<tr>
<td align="left">getLocationX</td>
<td align="left">Number</td>
<td align="left">获取鼠标的 X 轴位置</td>
</tr>
<tr>
<td align="left">getLocationY</td>
<td align="left">Number</td>
<td align="left">获取鼠标的 Y 轴位置</td>
</tr>
<tr>
<td align="left">getPreviousLocation</td>
<td align="left">Object</td>
<td align="left">获取鼠标事件上次触发时的位置对象，对象包含 x 和 y 属性</td>
</tr>
<tr>
<td align="left">getDelta</td>
<td align="left">Object</td>
<td align="left">获取鼠标距离上一次事件移动的距离对象，对象包含 x 和 y 属性</td>
</tr>
<tr>
<td align="left">getButton</td>
<td align="left">Number</td>
<td align="left">cc.Event.EventMouse.BUTTON_LEFT或cc.Event.EventMouse.BUTTON_RIGHT或cc.Event.EventMouse.BUTTON_MIDDLE</td>
</tr>
</tbody></table>
<p><strong>（2）触摸事件类型和事件对象</strong></p>
<table>
<thead>
<tr>
<th align="left">枚举对象定义</th>
<th align="left">对应的事件名</th>
<th align="left">事件触发的时机</th>
</tr>
</thead>
<tbody><tr>
<td align="left">cc.Node.EventType.TOUCH_START</td>
<td align="left">touchstart</td>
<td align="left">当手指触点落在目标节点区域内时</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.TOUCH_MOVE</td>
<td align="left">touchmove</td>
<td align="left">当手指在屏幕上目标节点区域内移动时</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.TOUCH_END</td>
<td align="left">touchend</td>
<td align="left">当手指在目标节点区域内离开屏幕时</td>
</tr>
<tr>
<td align="left">cc.Node.EventType.TOUCH_CANCEL</td>
<td align="left">touchcancel</td>
<td align="left">当手指在目标节点区域外离开屏幕时</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">API 名</th>
<th align="left">类型</th>
<th align="left">意义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">touch</td>
<td align="left">cc.Touch</td>
<td align="left">与当前事件关联的触点对象</td>
</tr>
<tr>
<td align="left">getID</td>
<td align="left">Number</td>
<td align="left">获取触点的 ID，用于多点触摸的逻辑判断</td>
</tr>
<tr>
<td align="left">getLocation</td>
<td align="left">Object</td>
<td align="left">获取触点位置对象，对象包含 x 和 y 属性</td>
</tr>
<tr>
<td align="left">getLocationX</td>
<td align="left">Number</td>
<td align="left">获取触点的 X 轴位置</td>
</tr>
<tr>
<td align="left">getLocationY</td>
<td align="left">Number</td>
<td align="left">获取触点的 Y 轴位置</td>
</tr>
<tr>
<td align="left">getPreviousLocation</td>
<td align="left">Object</td>
<td align="left">获取触点上一次触发事件时的位置对象，对象包含 x 和 y 属性</td>
</tr>
<tr>
<td align="left">getStartLocation</td>
<td align="left">Object</td>
<td align="left">获取触点初始时的位置对象，对象包含 x 和 y 属性</td>
</tr>
<tr>
<td align="left">getDelta</td>
<td align="left">Object</td>
<td align="left">获取触点距离上一次事件移动的距离对象，对象包含 x 和 y 属性</td>
</tr>
</tbody></table>
<p><strong>（3）其它事件</strong></p>
<table>
<thead>
<tr>
<th align="left">枚举对象定义</th>
<th align="left">对应的事件名</th>
<th align="left">事件触发的时机</th>
</tr>
</thead>
<tbody><tr>
<td align="left">无</td>
<td align="left">position-changed</td>
<td align="left">当位置属性修改时</td>
</tr>
<tr>
<td align="left">无</td>
<td align="left">rotation-changed</td>
<td align="left">当旋转属性修改时</td>
</tr>
<tr>
<td align="left">无</td>
<td align="left">scale-changed</td>
<td align="left">当缩放属性修改时</td>
</tr>
<tr>
<td align="left">无</td>
<td align="left">size-changed</td>
<td align="left">当宽高属性修改时</td>
</tr>
<tr>
<td align="left">无</td>
<td align="left">anchor-changed</td>
<td align="left">当锚点属性修改时</td>
</tr>
</tbody></table>
<blockquote>
<p>PS：枚举对象定义、事件名等价，在回调参数中，作用相同。</p>
</blockquote>
<h3 id="10、全局系统事件"><a href="#10、全局系统事件" class="headerlink" title="10、全局系统事件"></a>10、全局系统事件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局系统事件的类型</span></span><br><span class="line">cc.SystemEvent.EventType.KEY_DOWN    <span class="comment">//键盘按下</span></span><br><span class="line">cc.SystemEvent.EventType.KEY_UP    <span class="comment">//键盘释放</span></span><br><span class="line">cc.SystemEvent.EventType.DEVICEMOTION    <span class="comment">//设备重力传感</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//绑定、解除全局系统事件</span></span><br><span class="line">cc.systemEvent.<span class="keyword">on</span>(<span class="keyword">event</span>, fn, target, boolean);</span><br><span class="line">cc.systemEvent.off(<span class="keyword">event</span>, fn, target, boolean);</span><br></pre></td></tr></table></figure>

<h3 id="11、动作系统（变换系统）"><a href="#11、动作系统（变换系统）" class="headerlink" title="11、动作系统（变换系统）"></a>11、动作系统（变换系统）</h3><p><strong>（1）动作控制</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行动作</span></span><br><span class="line">node.runAction(action);</span><br><span class="line"><span class="comment">// 停止一个动作</span></span><br><span class="line">node.stopAction(action);</span><br><span class="line"><span class="comment">// 停止所有动作</span></span><br><span class="line">node.stopAllActions();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给 action 设置 tag</span></span><br><span class="line"><span class="keyword">var</span> ACTION_TAG = <span class="number">1</span>;</span><br><span class="line">action.setTag(ACTION_TAG);</span><br><span class="line"><span class="comment">// 通过 tag 获取 action</span></span><br><span class="line">node.getActionByTag(ACTION_TAG);</span><br><span class="line"><span class="comment">// 通过 tag 停止一个动作</span></span><br><span class="line">node.stopActionByTag(ACTION_TAG);</span><br></pre></td></tr></table></figure>

<p><strong>（2）容器动作</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//顺序执行</span></span><br><span class="line">cc.sequence(action1, action2, ...);</span><br><span class="line"><span class="comment">//并发执行</span></span><br><span class="line">cc.spawn(action1, action2, ...);</span><br><span class="line"><span class="comment">//指定次数，重复执行</span></span><br><span class="line">cc.<span class="keyword">repeat</span>(action, times)</span><br><span class="line"><span class="comment">//无限次数，重复执行</span></span><br><span class="line">cc.repeatForever(action)</span><br><span class="line"><span class="comment">//改变动作速度倍率，再执行</span></span><br><span class="line">cc.speed(action, rate)</span><br></pre></td></tr></table></figure>

<p><strong>（3）即时动作</strong></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc.<span class="keyword">show</span>()    <span class="comment">//立即显示</span></span><br><span class="line">cc.<span class="keyword">hide</span>()    <span class="comment">//立即隐藏</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><strong>（4）时间间隔动作</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cc.moveTo()    <span class="comment">//移动到目标位置</span></span><br><span class="line">cc.rotateTo()    <span class="comment">//旋转到目标角度</span></span><br><span class="line">cc.scaleTo()    <span class="comment">//将节点大小缩放到指定的倍数</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><strong>（5）动作回调</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> finished = cc.callFunc(fn, target, arg);</span><br></pre></td></tr></table></figure>

<p><strong>（6）缓动动作</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> action = cc.scaleTo(<span class="number">0.5</span>, <span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">//使用easeIn曲线，丰富动作表现</span></span><br><span class="line">action.easing(cc.easeIn(<span class="number">3.0</span>));</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PS：可以使用<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fdocs.cocos.com%2Fcreator%2Fmanual%2Fzh%2Fscripting%2Ftween.html" target="_blank" rel="noopener">缓动系统</a>，代替动作系统。（缓动系统的API更简约）</p>
</blockquote>
<h3 id="12、计时器"><a href="#12、计时器" class="headerlink" title="12、计时器"></a>12、计时器</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//interval：以秒为单位的时间间隔</span></span><br><span class="line"><span class="comment">//repeat：重复次数</span></span><br><span class="line"><span class="comment">//delay：开始延时</span></span><br><span class="line"><span class="keyword">this</span>.schedule(fn, interval, repeat, delay)</span><br><span class="line"><span class="keyword">this</span>.unschedule(fn)</span><br></pre></td></tr></table></figure>

<h3 id="13、脚本执行顺序"><a href="#13、脚本执行顺序" class="headerlink" title="13、脚本执行顺序"></a>13、脚本执行顺序</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">editor: &#123;</span><br><span class="line">        <span class="comment">//executionOrder越小，该组件相对其它组件就会越先执行（默认为0）</span></span><br><span class="line">        <span class="comment">//executionOrder只对 onLoad, onEnable, start, update 和 lateUpdate 有效，对 onDisable 和 onDestroy 无效</span></span><br><span class="line">        executionOrder: <span class="number">1</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="14、标准网络接口"><a href="#14、标准网络接口" class="headerlink" title="14、标准网络接口"></a>14、标准网络接口</h3><p><strong>（1）XMLHttpRequest——短连接</strong><br> <strong>（2）WebSocket——长连接</strong></p>
<h3 id="15、对象池"><a href="#15、对象池" class="headerlink" title="15、对象池"></a>15、对象池</h3><p><strong>对象池的概念</strong><br> 在同一场景中，需要多次进行节点的生成、消失时，假如直接进行创建、销毁的操作，就会很浪费性能。因此，使用对象池，存储需要消失的节点，释放需要生成的节点，达到节点回收利用的目的。</p>
<p><strong>工作流程</strong><br> （1）初始化对象池</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">properties: &#123;</span><br><span class="line">    enemyPrefab: cc.Prefab    <span class="comment">//准备预制资源</span></span><br><span class="line">&#125;,</span><br><span class="line">onLoad: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.enemyPool = <span class="keyword">new</span> cc.NodePool();</span><br><span class="line">    <span class="keyword">let</span> initCount = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; initCount; ++i) &#123;</span><br><span class="line">        <span class="keyword">let</span> enemy = cc.instantiate(<span class="keyword">this</span>.enemyPrefab); <span class="comment">// 创建节点</span></span><br><span class="line">        <span class="keyword">this</span>.enemyPool.put(enemy); <span class="comment">// 通过 put 接口放入对象池</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（2）从对象池请求对象</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">createEnemy: function (parentNode) &#123;</span><br><span class="line">    let enemy = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.enemyPool.size() &gt; <span class="number">0</span>) &#123; <span class="comment">// 通过 size 接口判断对象池中是否有空闲的对象</span></span><br><span class="line">        enemy = <span class="keyword">this</span>.enemyPool.<span class="keyword">get</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// 如果没有空闲对象，也就是对象池中备用对象不够时，我们就用 cc.instantiate 重新创建</span></span><br><span class="line">        enemy = cc.instantiate(<span class="keyword">this</span>.enemyPrefab);</span><br><span class="line">    &#125;</span><br><span class="line">    enemy.parent = parentNode; <span class="comment">// 将生成的敌人加入节点树</span></span><br><span class="line">    enemy.getComponent(<span class="string">'Enemy'</span>).<span class="keyword">init</span>(); <span class="comment">//接下来就可以调用 enemy 身上的脚本进行初始化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（3）将对象返回对象池</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">onEnemyKilled: <span class="function"><span class="keyword">function</span> (<span class="params">enemy</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// enemy 应该是一个 cc.Node</span></span><br><span class="line">    <span class="keyword">this</span>.enemyPool.put(enemy); <span class="comment">// 和初始化时的方法一样，将节点放进对象池，这个方法会同时调用节点的 removeFromParent</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>清除对象池</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//手动清空对象池，销毁其中缓存的所有节点</span></span><br><span class="line">myPool.clear();</span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title=""></a></h3>
      
      <!-- reward -->
      
      <div id="reward-btn">
        打赏
      </div>
      
    </div>
    
    
      <!-- copyright -->
      
        <div class="declare">
          <ul class="post-copyright">
            <li>
              <i class="ri-copyright-line"></i>
              <strong>版权声明： </strong s>
              本博客所有文章除特别声明外，均采用 <a href="https://www.apache.org/licenses/LICENSE-2.0.html" rel="external nofollow"
                target="_blank">Apache License 2.0</a> 许可协议。转载请注明出处！
            </li>
          </ul>
        </div>
        
    <footer class="article-footer">
      
          
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://hardy-j.github.io/2019/Cocos2/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%B8%E6%88%8F/" rel="tag">游戏</a></li></ul>


    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="/2019/miniapp/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            小程序
          
        </div>
      </a>
    
    
      <a href="/2019/Cocos/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">初识CocosCreator</div>
      </a>
    
  </nav>


  

  
  
<!-- valine评论 -->
<div id="vcomments-box">
    <div id="vcomments">
    </div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: '4lMN6RHpvnUqd3kEHEgbqAFC-gzGzoHsz',
        app_key: 'xVy7gCm3aO6aXtxMJwhoWTsw',
        path: window.location.pathname,
        notify: 'false',
        verify: 'false',
        avatar: 'mp',
        placeholder: '给我的文章加点评论吧~',
        recordIP: true
    });
    const infoEle = document.querySelector('#vcomments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
        infoEle.childNodes.forEach(function (item) {
            item.parentNode.removeChild(item);
        });
    }
</script>
<style>
    #vcomments-box {
        padding: 5px 30px;
    }

    @media screen and (max-width: 800px) {
        #vcomments-box {
            padding: 5px 0px;
        }
    }

    #vcomments-box #vcomments {
        background-color: #fff;
    }

    .v .vlist .vcard .vh {
        padding-right: 20px;
    }

    .v .vlist .vcard {
        padding-left: 10px;
    }
</style>

  

  
  
  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2020
        A_Hui
      </li>
      <li>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <span>
  <i>PV:<span id="busuanzi_value_page_pv"></span></i>
  <i>UV:<span id="busuanzi_value_site_uv"></span></i>
</span>
        
      </li>
      
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Hui&#39;Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="https://hui-starshine.lofter.com/" target="_blank" rel="noopener">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2020/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script>
  try {
    var typed = new Typed("#subtitle", {
      strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
      startDelay: 100,
      typeSpeed: 300,
      loop: true,
      backSpeed: 100,
      showCursor: true
    });
  } catch (err) {
  }

</script>




<script src="/js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>



<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>



<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>





<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

  
<script src="/js/clickLove.js"></script>



    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=1338575117&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
  </div>
</body>

</html>